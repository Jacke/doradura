# üîß –†–µ—à–µ–Ω–∏–µ: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ü–æ—Ä—Ç–∞ 9090

## –ü—Ä–æ–±–ª–µ–º–∞

```
http://0.0.0.0:9090/metrics
Forbidden
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ—Ä—Ç 9090 —É–∂–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, Electron app).

–õ–æ–≥ –±–æ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
```
[ERROR] Metrics server error: Address already in use (os error 48)
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (–ü—Ä–∏–º–µ–Ω–µ–Ω–æ)

### 1. –ò–∑–º–µ–Ω–µ–Ω –ø–æ—Ä—Ç metrics —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ **9094**

–û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª `.env`:
```bash
METRICS_ENABLED=true
METRICS_PORT=9094  # –í–º–µ—Å—Ç–æ 9090
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prometheus

–§–∞–π–ª `prometheus.yml`:
```yaml
- job_name: 'doradura-bot'
  static_configs:
    - targets: ['host.docker.internal:9094']  # –í–º–µ—Å—Ç–æ 9090
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `QUICKSTART_MONITORING.md` - –Ω–æ–≤—ã–π URL
- `.env.example` - –Ω–æ–≤—ã–π default –ø–æ—Ä—Ç

## üöÄ –ö–∞–∫ –ü—Ä–∏–º–µ–Ω–∏—Ç—å

### –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C)
cargo run --release
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
[INFO] Starting metrics server on port 9094
[INFO] Metrics available at http://0.0.0.0:9094/metrics
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å metrics endpoint

```bash
curl http://localhost:9094/metrics
curl http://localhost:9094/health
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ Prometheus —Ñ–æ—Ä–º–∞—Ç–µ.

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
./scripts/start-monitoring.sh
```

Prometheus –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ –±–æ—Ç—É –Ω–∞ –ø–æ—Ä—Ç—É 9094.

## üìä –ù–æ–≤—ã–µ URL

| –°–µ—Ä–≤–∏—Å | –°—Ç–∞—Ä—ã–π URL | –ù–æ–≤—ã–π URL |
|--------|-----------|-----------|
| Bot Metrics | ~~http://localhost:9090/metrics~~ | **http://localhost:9094/metrics** |
| Prometheus | http://localhost:9091 | http://localhost:9091 |
| Grafana | http://localhost:3000 | http://localhost:3000 |

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health
./scripts/check-metrics.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç 9094 —Å–ª—É—à–∞–µ—Ç—Å—è
lsof -i :9094

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å targets –≤ Prometheus
curl http://localhost:9091/api/v1/targets | jq '.data.activeTargets[] | select(.labels.job=="doradura-bot")'
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å `"health": "up"`.

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –†–µ—à–µ–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–æ—Ä—Ç 9090

–ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 9090:
```bash
lsof -i :9090
```

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ (–µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω):
```bash
kill -9 <PID>
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã
netstat -an | grep LISTEN | grep 909

# –í—ã–±—Ä–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 9095)
METRICS_PORT=9095
```

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å `prometheus.yml`.

## ‚úÖ Checklist

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è:

- [x] `.env` –æ–±–Ω–æ–≤–ª–µ–Ω —Å `METRICS_PORT=9094`
- [x] `prometheus.yml` –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø–æ—Ä—Ç 9094
- [x] `.env.example` –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- [x] `QUICKSTART_MONITORING.md` –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] –ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] Metrics endpoint –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ :9094
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω
- [ ] Prometheus —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏

## üéØ –ò—Ç–æ–≥

**–ü–æ—Ä—Ç –∏–∑–º–µ–Ω–µ–Ω: 9090 ‚Üí 9094**

–í—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞! üöÄ
