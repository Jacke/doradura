# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "android client https formats require a GVS PO Token"

## üî• –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏ –≤–∏–¥–µ–æ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:

```
WARNING: [youtube] android client https formats require a GVS PO Token which was not provided. 
They will be skipped as they may yield HTTP Error 403. 
You can manually pass a GVS PO Token for this client with --extractor-args "youtube:po_token=android.gvs+XXX"

ERROR: [youtube] Requested format is not available. Use --list-formats for a list of available formats
```

## ü§î –ü—Ä–∏—á–∏–Ω–∞

**YouTube –∏–∑–º–µ–Ω–∏–ª –ø–æ–ª–∏—Ç–∏–∫—É –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–∏–¥–µ–æ!**

–†–∞–Ω—å—à–µ (–¥–æ –Ω–µ–¥–∞–≤–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏):
- ‚úÖ Android –∫–ª–∏–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–ª –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–ª —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–æ—Ä–º–∞—Ç–∞–º –≤–∏–¥–µ–æ

–¢–µ–ø–µ—Ä—å (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π YouTube):
- ‚ùå Android –∫–ª–∏–µ–Ω—Ç —Ç—Ä–µ–±—É–µ—Ç **PO Token** (Proof of Origin Token)
- ‚ùå –ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ —Ñ–æ—Ä–º–∞—Ç—ã –≤–∏–¥–µ–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã ‚Üí –æ—à–∏–±–∫–∞ "Requested format is not available"
- ‚ùå –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PO Token - —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

–í –∫–æ–¥–µ –±—ã–ª —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:
```rust
// –ò—Å–ø–æ–ª—å–∑—É–µ–º android –∫–ª–∏–µ–Ω—Ç –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç PO Token
// Android —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
```

–≠—Ç–æ –±–æ–ª—å—à–µ **–ù–ï –∞–∫—Ç—É–∞–ª—å–Ω–æ**! üòÖ

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

**–£–±—Ä–∞–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Android –∫–ª–∏–µ–Ω—Ç–∞** –∏ –≤–µ—Ä–Ω—É–ª–∏—Å—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É Web –∫–ª–∏–µ–Ω—Ç—É YouTube.

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

**–î–û (—Å –æ—à–∏–±–∫–æ–π):**
```rust
let player_client_str = "youtube:player_client=android".to_string();
args.extend_from_slice(&[
    "--extractor-args", &player_client_str,
    "--no-check-certificate",
    &url_str,
]);
```

**–ü–û–°–õ–ï (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):**
```rust
// –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ–º android –∫–ª–∏–µ–Ω—Ç!
// YouTube –∏–∑–º–µ–Ω–∏–ª –ø–æ–ª–∏—Ç–∏–∫—É: —Ç–µ–ø–µ—Ä—å Android —Ç—Ä–µ–±—É–µ—Ç PO Token
// –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π web –∫–ª–∏–µ–Ω—Ç –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å cookies

args.extend_from_slice(&[
    "--no-check-certificate",
    &url_str,
]);
```

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

1. ‚úÖ `get_metadata_from_ytdlp()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ `download_audio_file_with_progress()` - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∞—É–¥–∏–æ
3. ‚úÖ `download_video_file_with_progress()` - —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ

–í—Å–µ —Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–¥–µ—Ñ–æ–ª—Ç–Ω—ã–π Web –∫–ª–∏–µ–Ω—Ç** –≤–º–µ—Å—Ç–æ Android.

## üéØ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
pkill -f doradura

# 2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
cd /Users/stan/Dev/_PROJ/doradura
cargo build --release

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å–Ω–æ–≤–∞
./target/release/doradura
```

**–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ –±—É–¥—É—Ç —Å–∫–∞—á–∏–≤–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫!** ‚ú®

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Web –∫–ª–∏–µ–Ω—Ç–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Android –∫–ª–∏–µ–Ω—Ç | Web –∫–ª–∏–µ–Ω—Ç |
|----------|----------------|------------|
| –¢—Ä–µ–±—É–µ—Ç PO Token | ‚ùå –î–∞ (—Å 2024) | ‚úÖ –ù–µ—Ç |
| –†–∞–±–æ—Ç–∞–µ—Ç —Å cookies | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| –î–æ—Å—Ç—É–ø –∫ —Ñ–æ—Ä–º–∞—Ç–∞–º | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω –±–µ–∑ PO Token | ‚úÖ –ü–æ–ª–Ω—ã–π —Å cookies |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | üîß –°–ª–æ–∂–Ω–∞—è (–Ω—É–∂–µ–Ω PO Token) | ‚úÖ –ü—Ä–æ—Å—Ç–∞—è (—Ç–æ–ª—å–∫–æ cookies) |
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç PO Token | ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ |

## üîç –ß—Ç–æ —Ç–∞–∫–æ–µ PO Token?

**PO Token (Proof of Origin Token)** - —ç—Ç–æ —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π YouTube –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞.

### –ó–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?
YouTube –≤–≤—ë–ª PO Token –¥–ª—è –±–æ—Ä—å–±—ã —Å –±–æ—Ç–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞–º–∏.

### –ö–∞–∫ –µ–≥–æ –ø–æ–ª—É—á–∏—Ç—å?
–≠—Ç–æ —Å–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ç—Ä–µ–±—É—é—â–∏–π:
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è YouTube
2. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (—Ç–æ–∫–µ–Ω—ã –∏—Å—Ç–µ–∫–∞—é—Ç)
3. –ù–∞—Å—Ç—Ä–æ–π–∫—É —á–µ—Ä–µ–∑ `--extractor-args "youtube:po_token=android.gvs+XXX"`

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: https://github.com/yt-dlp/yt-dlp/wiki/PO-Token-Guide

### –ù—É–∂–µ–Ω –ª–∏ –æ–Ω –Ω–∞–º?
**–ù–µ—Ç!** –î–ª—è –Ω–∞—à–∏—Ö —Ü–µ–ª–µ–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Web –∫–ª–∏–µ–Ω—Ç–∞ —Å cookies:
- ‚úÖ –ü—Ä–æ—â–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ (—Ç–æ–ª—å–∫–æ cookies)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ–æ—Ä–º–∞—Ç–∞–º

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
export RUST_LOG=doradura=debug
./target/release/doradura
```

–°–∫–∞—á–∞–π—Ç–µ –≤–∏–¥–µ–æ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```
[DEBUG] yt-dlp stdout: [youtube] Downloading webpage
[DEBUG] yt-dlp stdout: [youtube] Extracting video information
[DEBUG] Progress parsed successfully: 15%
[DEBUG] Progress parsed successfully: 30%
```

**‚ùå –û–®–ò–ë–ö–ê (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```
[DEBUG] yt-dlp stderr: WARNING: android client https formats require a GVS PO Token
[DEBUG] yt-dlp stderr: ERROR: Requested format is not available
[ERROR] An error occurred during video download: Download("downloader exited with status: exit status: 1")
```

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã Web –∫–ª–∏–µ–Ω—Ç–∞ –Ω—É–∂–Ω—ã **–Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ cookies**:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ª–∏ cookies
grep "cookies" /path/to/logs

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
# [INFO] Using cookies from file: /path/to/cookies.txt
# –∏–ª–∏
# [INFO] Using cookies from browser: chrome
```

–ï—Å–ª–∏ cookies –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã, —Å–º.: **MACOS_COOKIES_FIX.md**

## üöÄ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤–µ—Ä–Ω—É—Ç—å Android –∫–ª–∏–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤), –º–æ–∂–Ω–æ:

1. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É PO Token:**
```rust
// –í config.rs
pub static PO_TOKEN: once_cell::sync::Lazy<String> = 
    once_cell::sync::Lazy::new(|| {
        std::env::var("YTDL_PO_TOKEN").unwrap_or_default()
    });

// –í downloader.rs
if !config::PO_TOKEN.is_empty() {
    let po_token_arg = format!("youtube:po_token=android.gvs+{}", *config::PO_TOKEN);
    args.push("--extractor-args");
    args.push(&po_token_arg);
}
```

2. **–°–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–º:**
```bash
# –í .env
YTDL_PLAYER_CLIENT=web  # –∏–ª–∏ android, ios
```

–ù–æ –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞—á Web –∫–ª–∏–µ–Ω—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω**! ‚úÖ

## üìö –°—Å—ã–ª–∫–∏

- **PO Token Guide:** https://github.com/yt-dlp/yt-dlp/wiki/PO-Token-Guide
- **yt-dlp Extractor Args:** https://github.com/yt-dlp/yt-dlp#youtube
- **Cookies Setup:** MACOS_COOKIES_FIX.md

## ‚úÖ –ò—Ç–æ–≥

- ‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞:** Android –∫–ª–∏–µ–Ω—Ç —Ç—Ä–µ–±—É–µ—Ç PO Token
- ‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º Web –∫–ª–∏–µ–Ω—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å cookies)
- ‚úÖ **–î–µ–π—Å—Ç–≤–∏–µ:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π
- ‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í–∏–¥–µ–æ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

**–ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π!** üéâ

