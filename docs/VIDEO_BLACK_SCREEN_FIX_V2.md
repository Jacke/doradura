# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –≤ –≤–∏–¥–µ–æ - v2

## üî• –ü—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω.

## ü§î –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)

1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –ø–æ—Ç–æ–∫–æ–≤** - `bestvideo+bestaudio` –Ω–µ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. **–í–∏–¥–µ–æ –±–µ–∑ –≤–∏–¥–µ–æ –¥–æ—Ä–æ–∂–∫–∏** - —Å–∫–∞—á–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∞—É–¥–∏–æ
3. **–í–∏–¥–µ–æ –±–µ–∑ –∞—É–¥–∏–æ –¥–æ—Ä–æ–∂–∫–∏** - —Å–∫–∞—á–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –≤–∏–¥–µ–æ
4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç/–∫–æ–¥–µ–∫** - —Ö–æ—Ç—è –æ–±—ã—á–Ω–æ —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è v2

### 1. –ò–∑–º–µ–Ω—ë–Ω —Ñ–æ—Ä–º–∞—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

**–ë–´–õ–û (–ø—Ä–æ–±–ª–µ–º–Ω–æ–µ):**
```rust
"bestvideo[height<=1080]+bestaudio/best[height<=1080]"
```

–ü—Ä–æ–±–ª–µ–º–∞: `bestvideo+bestaudio` —Ç—Ä–µ–±—É–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–≤—É—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤, —á—Ç–æ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –æ—à–∏–±–∫–æ–π –∏–ª–∏ –Ω–µ–ø–æ–ª–Ω—ã–º —Ñ–∞–π–ª–æ–º.

**–°–¢–ê–õ–û (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):**
```rust
"best[height<=1080]"
```

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- ‚úÖ `best` –≤—ã–±–∏—Ä–∞–µ—Ç **–≥–æ—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ —Å –∞—É–¥–∏–æ**, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤
- ‚úÖ –ú–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ–∫
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Ä–æ–∂–µ–∫

–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `has_both_video_and_audio()`:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤–∏–¥–µ–æ –¥–æ—Ä–æ–∂–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∞—É–¥–∏–æ –¥–æ—Ä–æ–∂–∫–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### 3. –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –†–∞–∑–º–µ—Ä —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Ä–æ–∂–∫–∞—Ö
- –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### 4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ë–´–õ–û (–º–µ–¥–ª–µ–Ω–Ω–æ):**
```rust
"--postprocessor-args", "ffmpeg:-c:v libx264 -preset fast -crf 23 -c:a aac -b:a 128k -movflags +faststart"
```
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–∏–¥–µ–æ ‚Üí –º–µ–¥–ª–µ–Ω–Ω–æ.

**–°–¢–ê–õ–û (–±—ã—Å—Ç—Ä–µ–µ):**
```rust
"--postprocessor-args", "ffmpeg:-movflags +faststart"
```
–¢–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è streaming, –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è ‚Üí –±—ã—Å—Ç—Ä–µ–µ.

## üöÄ –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å

```bash
# 1. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
cd /Users/stan/Dev/_PROJ/doradura
cargo build --release

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
./target/release/doradura
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –®–∞–≥ 1: –í–∫–ª—é—á–∏—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏

```bash
export RUST_LOG=doradura=debug
./target/release/doradura
```

### –®–∞–≥ 2: –°–∫–∞—á–∞–π—Ç–µ –≤–∏–¥–µ–æ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

**‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):**
```
[INFO] Using video format: best
[INFO] Video downloaded in XX seconds
[INFO] Downloaded video file size: XX.XX MB
[INFO] Video file verified: contains both video and audio streams
[INFO] Video metadata for /path/to/video.mp4: Some((180, Some(1280), Some(720)))
```

**‚ùå –ü—Ä–æ–±–ª–µ–º–∞ (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π —Ñ–∞–π–ª):**
```
[INFO] Using video format: bestvideo[height<=720]+bestaudio/best[height<=720]
[ERROR] Video file is missing video or audio stream!
[ERROR] This can cause black screen or playback issues in Telegram
[ERROR] File streams info: ...
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Ä–æ–∂–∫–∏
ffprobe /path/to/downloads/video.mp4

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
# Stream #0:0: Video: h264 (...)     <- –≤–∏–¥–µ–æ –¥–æ—Ä–æ–∂–∫–∞
# Stream #0:1: Audio: aac (...)     <- –∞—É–¥–∏–æ –¥–æ—Ä–æ–∂–∫–∞
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –¥–æ—Ä–æ–∂–∫—É ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º.

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–µ–∫

```bash
ffprobe -v error -select_streams v:0 -show_entries stream=codec_name /path/to/downloads/video.mp4
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: h264

ffprobe -v error -select_streams a:0 -show_entries stream=codec_name /path/to/downloads/video.mp4
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: aac
```

## üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –≤—Å—ë –µ—â—ë –µ—Å—Ç—å

–ú–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞–¥—ë–∂–Ω–µ–µ):

```rust
// –í download_video_file_with_progress, –∑–∞–º–µ–Ω–∏—Ç–µ:
"--postprocessor-args", "ffmpeg:-movflags +faststart",

// –ù–∞:
"--postprocessor-args", "ffmpeg:-c:v libx264 -preset fast -crf 23 -c:a aac -b:a 128k -movflags +faststart",
```

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤–∏–¥–µ–æ

```bash
# –°–∫–∞—á–∞–π—Ç–µ –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ yt-dlp
yt-dlp --format "best[height<=720]" -o "test_video.mp4" "URL"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª
ffprobe test_video.mp4

# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–∫—Ä—ã—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
open test_video.mp4  # macOS
```

–ï—Å–ª–∏ –≤–∏–¥–µ–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–æ –Ω–µ –≤ Telegram ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–æ–º.
–ï—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º.

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤

| –§–æ—Ä–º–∞—Ç | –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ | –°–∫–æ—Ä–æ—Å—Ç—å | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å |
|--------|-------------|----------|------------|
| `bestvideo+bestaudio` | ‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è | ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ | ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–º |
| `best` | ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è | ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ | ‚úÖ –ù–∞–¥—ë–∂–Ω–µ–µ |

## ‚úÖ –ò—Ç–æ–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- ‚úÖ –§–æ—Ä–º–∞—Ç –∏–∑–º–µ–Ω—ë–Ω —Å `bestvideo+bestaudio` –Ω–∞ `best`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ –¥–æ—Ä–æ–∂–µ–∫
- ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–±—ã—Å—Ç—Ä–µ–µ)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫

## üéØ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** - –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å "best" —Ñ–æ—Ä–º–∞—Ç –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Ä–æ–∂–µ–∫
2. **–°–∫–∞—á–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –≤–∏–¥–µ–æ**
3. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ Telegram** - –¥–æ–ª–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è
4. **–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë —á–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω** - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ (—Å–º. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—ã—à–µ)

## üö® –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∏–¥–µ–æ:**
   ```bash
   ffprobe /path/to/downloads/video.mp4 2>&1 | grep -E "(Stream|Video|Audio)"
   ```

2. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π URL** - –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–∏–¥–µ–æ

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é yt-dlp:**
   ```bash
   yt-dlp --version
   ```
   –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è.

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ cookies:**
   ```bash
   grep "cookies" /path/to/logs
   ```

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **VIDEO_BLACK_SCREEN_FIX.md** - –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)
- **YOUTUBE_PO_TOKEN_FIX.md** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ PO Token
- **SESSION_SUMMARY.md** - –ü–æ–ª–Ω–æ–µ —Ä–µ–∑—é–º–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

