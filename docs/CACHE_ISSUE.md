# –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö "Unknown Track"

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ –≤—Å–µ –µ—â–µ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è —Å –∏–º–µ–Ω–µ–º "Unknown Track.mp4" –∏–ª–∏ "Unknown.mp4".

## –ü—Ä–∏—á–∏–Ω–∞

**–ö—ç—à –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∂–∏–≤–µ—Ç 24 —á–∞—Å–∞!**

```rust
// src/cache.rs
static METADATA_CACHE: once_cell::sync::Lazy<MetadataCache> = once_cell::sync::Lazy::new(|| {
    MetadataCache::new(Duration::from_secs(24 * 60 * 60)) // 24 —á–∞—Å–∞ ‚è∞
});
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
1. –ï—Å–ª–∏ —Ä–∞–Ω—å—à–µ –≤–∏–¥–µ–æ —Å–∫–∞—á–∏–≤–∞–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π ‚Üí –ø–æ–ª—É—á–∏–ª–æ –Ω–∞–∑–≤–∞–Ω–∏–µ "Unknown Track"
2. –≠—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ **—Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å –≤ –∫—ç—à–µ** –Ω–∞ 24 —á–∞—Å–∞
3. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –∂–µ –≤–∏–¥–µ–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ** –∏–∑ –∫—ç—à–∞
4. –î–∞–∂–µ –µ—Å–ª–∏ –∫–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, —Å—Ç–∞—Ä–æ–µ "Unknown Track" –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –∫—ç—à–∞

## –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ (–°–ê–ú–û–ï –ü–†–û–°–¢–û–ï) ‚ö°

–ö—ç—à –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏—Ç—Å—è **–≤ –ø–∞–º—è—Ç–∏** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø–æ—ç—Ç–æ–º—É:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
pkill -f doradura
# –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å–Ω–æ–≤–∞
./target/release/doradura
# –∏–ª–∏
cargo run --release
```

**–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∫—ç—à –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç—Å—è!** ‚ú®

### –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏

```bash
chmod +x clear_cache.sh
./clear_cache.sh
```

–°–∫—Ä–∏–ø—Ç –¥–∞—Å—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—á–∏—Å—Ç–∫–µ –∫—ç—à–∞.

### –†–µ—à–µ–Ω–∏–µ 3: –ü–æ–¥–æ–∂–¥–∏—Ç–µ 24 —á–∞—Å–∞ ‚è≥

–ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—Ç–µ—á—ë—Ç —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ —Å –º–æ–º–µ–Ω—Ç–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

### –†–µ—à–µ–Ω–∏–µ 4: –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–µ –≤–∏–¥–µ–æ üé¨

–ï—Å–ª–∏ –≤–∏–¥–µ–æ **–Ω–∏–∫–æ–≥–¥–∞ —Ä–∞–Ω—å—à–µ –Ω–µ —Å–∫–∞—á–∏–≤–∞–ª–æ—Å—å**, –µ–≥–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤ –∫—ç—à–µ, –∏ –æ–Ω–æ –ø–æ–ª—É—á–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞.

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
export RUST_LOG=doradura=debug
./target/release/doradura

# –°–∫–∞—á–∞–π—Ç–µ –≤–∏–¥–µ–æ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
[INFO] Successfully got metadata for video - title: '–†–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ', artist: ''
[DEBUG] Generating filename: title='–†–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ' (len=45), artist='' (len=0), ext='mp4'
[DEBUG] Using title only: '–†–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ.mp4'
[INFO] Generated filename for video: '–†–µ–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ.mp4'
```

## –ö–∞–∫ –∫—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç

```mermaid
graph TD
    A[–ó–∞–ø—Ä–æ—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è] --> B{–ï—Å—Ç—å –≤ –∫—ç—à–µ?}
    B -->|–î–∞| C[–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ]
    B -->|–ù–µ—Ç| D[–ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ—Ç yt-dlp]
    D --> E[–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫—ç—à –Ω–∞ 24 —á–∞—Å–∞]
    E --> F[–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ]
    C --> G[–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª]
    F --> G
```

## –£–ª—É—á—à–µ–Ω–∏—è (–¥–ª—è –±—É–¥—É—â–µ–≥–æ)

### 1. –£–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞

–í–º–µ—Å—Ç–æ 24 —á–∞—Å–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, 1 —á–∞—Å:

```rust
// src/cache.rs
static METADATA_CACHE: once_cell::sync::Lazy<MetadataCache> = once_cell::sync::Lazy::new(|| {
    MetadataCache::new(Duration::from_secs(60 * 60)) // 1 —á–∞—Å
});
```

### 2. –ù–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É, —á—Ç–æ–±—ã –Ω–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å "Unknown Track":

```rust
// src/downloader.rs
// –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
if !title.is_empty() && title != "Unknown Track" {
    cache::cache_metadata(url, title.clone(), artist.clone()).await;
}
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –±–æ—Ç–∞ `/clearcache` –¥–ª—è —Ä—É—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏.

### 4. –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ

–ï—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π, —É–¥–∞–ª—è—Ç—å —ç—Ç—É –∑–∞–ø–∏—Å—å –∏–∑ –∫—ç—à–∞:

```rust
if let Err(e) = get_metadata_from_ytdlp(&url).await {
    // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫—ç—à–∞ –µ—Å–ª–∏ –±—ã–ª–∞ –æ—à–∏–±–∫–∞
    cache::invalidate_cached_metadata(&url).await;
    return Err(e);
}
```

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

‚úÖ **–ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω** - –Ω–æ–≤—ã–µ –≤–∏–¥–µ–æ –±—É–¥—É—Ç –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è  
‚ö†Ô∏è **–ö—ç—à –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è** - –Ω—É–∂–µ–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫  
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–æ–∂–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã  
‚úÖ **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç clear_cache.sh** - –¥–ª—è —É–¥–æ–±–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏  

## TL;DR (–ö—Ä–∞—Ç–∫–æ)

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ä—ã–µ "Unknown Track" —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∫—ç—à–µ –Ω–∞ 24 —á–∞—Å–∞  
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ (–∫—ç—à –≤ –ø–∞–º—è—Ç–∏, –æ—á–∏—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)  
**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –°–∫–∞—á–∞–π—Ç–µ –≤–∏–¥–µ–æ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å `RUST_LOG=doradura=debug`

