# Doradura Telegram Mini App

–ë–∞–∑–æ–≤–æ–µ Telegram Mini App –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º—É–∑—ã–∫–∏ –∏ –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ Doradura.

## –ß—Ç–æ —ç—Ç–æ?

Telegram Mini App - —ç—Ç–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ Telegram –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram Web App API –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–æ—Ç–æ–º.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéµ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- **–ê—É–¥–∏–æ:** MP3 —Å –≤—ã–±–æ—Ä–æ–º –±–∏—Ç—Ä–µ–π—Ç–∞ (128k, 192k, 256k, 320k)
- **–í–∏–¥–µ–æ:** MP4 —Å –≤—ã–±–æ—Ä–æ–º –∫–∞—á–µ—Å—Ç–≤–∞ (360p, 480p, 720p, 1080p, best)
- **–°—É–±—Ç–∏—Ç—Ä—ã:** SRT —Ñ–æ—Ä–º–∞—Ç
- **Preview:** –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º (–Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ä–∞–∑–º–µ—Ä)

### üë§ –ü—Ä–æ—Ñ–∏–ª—å –∏ –ø–æ–¥–ø–∏—Å–∫–∏
- **–¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã:** Free, Premium, VIP —Å —Ä–∞–∑–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π:** –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–ª–∞–Ω–∞–º–∏ –≤ –æ–¥–∏–Ω –∫–ª–∏–∫
- **–û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ Free –ø–ª–∞–Ω
- **–õ–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –ª–∏–º–∏—Ç–æ–≤ –∏ –∫–≤–æ—Ç

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∑–æ–∫
- **–£—Å–ø–µ—à–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏:** –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Å–∫–∞—á–∏–≤–∞–Ω–∏–π —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
- **–û—à–∏–±–∫–∏:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- **–û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö:** –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä —Å–∫–∞—á–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### üìú –ò—Å—Ç–æ—Ä–∏—è –∏ –æ—á–µ—Ä–µ–¥—å
- **–ò—Å—Ç–æ—Ä–∏—è –∑–∞–≥—Ä—É–∑–æ–∫:** –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∑–∞–≥—Ä—É–∑–æ–∫ —Å —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∏ –¥–∞—Ç–∞–º–∏
- **–ê–∫—Ç–∏–≤–Ω–∞—è –æ—á–µ—Ä–µ–¥—å:** –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥)
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ (–≤ –æ—á–µ—Ä–µ–¥–∏, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –∑–∞–≤–µ—Ä—à–µ–Ω–æ)
- **–ü–æ–∑–∏—Ü–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞–¥–∞—á

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- **–§–æ—Ä–º–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏:** –û—Ç–ø—Ä–∞–≤–∫–∞ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç (–±–µ–∑ —Å–∂–∞—Ç–∏—è Telegram)
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏ –∫–∞—á–µ—Å—Ç–≤–∞
- **–°–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:** –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º (YouTube, Spotify, SoundCloud –∏ –¥—Ä.)

### üé® –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω:** –ü–æ–ª–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–¢–µ–º–Ω–∞—è —Ç–µ–º–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ —Ç–µ–º—É Telegram
- **–ù–∞–≤–∏–≥–∞—Ü–∏—è:** –£–¥–æ–±–Ω—ã–µ —Ç–∞–±—ã –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- **–¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å:** –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏—è—Ö (Haptic Feedback)
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** –ù–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–ø–∞–ø—ã –∏ –∞–ª–µ—Ä—Ç—ã Telegram

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **HMAC-SHA256 –≤–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Telegram
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è:** –ó–∞—â–∏—Ç–∞ –æ—Ç replay-–∞—Ç–∞–∫ (–¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è)
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ö–∞–∂–¥—ã–π API –∑–∞–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π Telegram init data

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
webapp/
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ index.html    # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Mini App
‚îÇ   ‚îî‚îÄ‚îÄ app.js        # JavaScript –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md         # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å –≤ —Å–≤–æ–π `.env` —Ñ–∞–π–ª:

```bash
# –ü–æ—Ä—Ç –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ Mini App
WEBAPP_PORT=8080

# –ü—É–±–ª–∏—á–Ω—ã–π URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Mini App (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
WEBAPP_URL=https://your-domain.com
```

**–í–∞–∂–Ω–æ:** `WEBAPP_URL` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —á–µ—Ä–µ–∑ HTTPS. Telegram —Ç—Ä–µ–±—É–µ—Ç HTTPS –¥–ª—è Mini Apps.

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS

–î–ª—è —Ä–∞–±–æ—Ç—ã Mini App —Ç—Ä–µ–±—É–µ—Ç—Å—è HTTPS. –í–∞—Ä–∏–∞–Ω—Ç—ã:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Nginx reverse proxy (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```nginx
server {
    listen 443 ssl;
    server_name your-domain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: ngrok (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

```bash
ngrok http 8080
```

Ngrok –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –ø—É–±–ª–∏—á–Ω—ã–π HTTPS URL, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ `WEBAPP_URL`.

### 3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Mini App –≤ BotFather

1. –û—Ç–∫—Ä–æ–π [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å –∫–æ–º–∞–Ω–¥—É `/mybots`
3. –í—ã–±–µ—Ä–∏ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞
4. –í—ã–±–µ—Ä–∏ "Bot Settings" ‚Üí "Menu Button"
5. –í—ã–±–µ—Ä–∏ "Configure menu button"
6. –û—Ç–ø—Ä–∞–≤—å —Ç–µ–∫—Å—Ç –¥–ª—è –∫–Ω–æ–ø–∫–∏: `üöÄ Mini App`
7. –û—Ç–ø—Ä–∞–≤—å URL —Ç–≤–æ–µ–≥–æ Mini App: `https://your-domain.com`

### 4. –ó–∞–ø—É—Å–∫

```bash
# –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
cargo run

# –ò–ª–∏ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
WEBAPP_PORT=8080 WEBAPP_URL=https://your-domain.com cargo run
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram   ‚îÇ
‚îÇ   Client    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚îÇ (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App)
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Web Browser   ‚îÇ
‚îÇ  (–≤–Ω—É—Ç—Ä–∏ TG)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ (–∑–∞–≥—Ä—É–∂–∞–µ—Ç index.html)
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Axum Web Server ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   (port 8080)    ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
         ‚îÇ                ‚îÇ
         ‚îÇ (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç    ‚îÇ (—Ö–æ—Å—Ç–∏—Ç
         ‚îÇ  web_app_data) ‚îÇ  —Å—Ç–∞—Ç–∏–∫—É)
         ‚îÇ                ‚îÇ
         ‚ñº                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  Telegram Bot    ‚îÇ      ‚îÇ
‚îÇ  (main.rs)       ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
         ‚îÇ                ‚îÇ
         ‚îÇ (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç  ‚îÇ
         ‚îÇ  –∑–∞–ø—Ä–æ—Å)       ‚îÇ
         ‚îÇ                ‚îÇ
         ‚ñº                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ Download Queue   ‚îÇ      ‚îÇ
‚îÇ  & Processing    ‚îÇ      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
                          ‚îÇ
                          ‚îÇ
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
  ‚îÇ
  ‚ñº
webapp/static/
‚îú‚îÄ‚îÄ index.html
‚îî‚îÄ‚îÄ app.js
```

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App:**
   - –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤ –±–æ—Ç–µ –∏–ª–∏ –≤ –º–µ–Ω—é –±–æ—Ç–∞
   - Telegram –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è `index.html` —Å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

2. **Mini App –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET –∑–∞–ø—Ä–æ—Å—ã –∫ REST API —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ `X-Telegram-Init-Data` header
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ñ–æ—Ä–º–∞—Ç, –∫–∞—á–µ—Å—Ç–≤–æ, –ø–ª–∞–Ω)
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –∏—Å—Ç–æ—Ä–∏—é, –∞–∫—Ç–∏–≤–Ω—É—é –æ—á–µ—Ä–µ–¥—å

3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º:**
   - –í—Å—Ç–∞–≤–ª—è–µ—Ç URL –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ
   - –í—ã–±–∏—Ä–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç (MP3/MP4/SRT) –∏ –∫–∞—á–µ—Å—Ç–≤–æ
   - –ú–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å preview –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
   - –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–°–∫–∞—á–∞—Ç—å"

4. **Mini App –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ:**
   - POST –∑–∞–ø—Ä–æ—Å –∫ `/api/download` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
   - Rate limiter –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏–º–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –ø–æ –ø–ª–∞–Ω—É
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è ID –∑–∞–¥–∞—á–∏ –∏ –ø–æ–∑–∏—Ü–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏

5. **–û—á–µ—Ä–µ–¥—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
   - JavaScript –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç GET `/api/user/:id/queue`
   - –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: pending, processing, completed
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–∑–∏—Ü–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å

6. **–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞:**
   - –û—á–µ—Ä–µ–¥—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É
   - yt-dlp —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª
   - –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ Telegram
   - –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –±–µ–∑ HTTPS –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Desktop –Ω–∞ —Ç–æ–º –∂–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:

1. –ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ: `WEBAPP_PORT=8080 cargo run`
2. –ò—Å–ø–æ–ª—å–∑—É–π ngrok –¥–ª—è HTTPS —Ç—É–Ω–Ω–µ–ª—è: `ngrok http 8080`
3. –û–±–Ω–æ–≤–∏ `WEBAPP_URL` —Å ngrok URL
4. –û—Ç–∫—Ä–æ–π –±–æ—Ç–∞ –≤ Telegram Desktop
5. –û—Ç–∫—Ä–æ–π Developer Tools –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

#### Frontend (webapp/static/)

- **index.html**: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Telegram –¥–ª—è —Ç–µ–º–∏–∑–∞—Ü–∏–∏
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

- **app.js**: –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App SDK
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
  - –í–∞–ª–∏–¥–∞—Ü–∏—è URL
  - –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É

#### Backend (src/telegram/webapp.rs)

- **WebAppData**: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Mini App
- **create_webapp_router()**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–æ–≤ –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- **run_webapp_server()**: –ó–∞–ø—É—Å–∫ Axum —Å–µ—Ä–≤–µ—Ä–∞

#### Integration (src/main.rs)

- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `web_app_data` –≤ dispatcher chain
- –ü–∞—Ä—Å–∏–Ω–≥ JSON –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∑–∞–≥—Ä—É–∑–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥—å

## REST API

Mini App –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π REST API. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç header `X-Telegram-Init-Data` —Å –≤–∞–ª–∏–¥–Ω—ã–º Telegram Web App init data.

### Endpoints

#### `GET /api/health`
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.

**Response:**
```json
{ "status": "ok", "message": "Mini App server is running" }
```

#### `POST /api/preview`
–ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º.

**Request:**
```json
{
  "url": "https://youtube.com/watch?v=...",
  "format": "mp3",
  "video_quality": "720p"
}
```

**Response:**
```json
{
  "title": "Song Title",
  "artist": "Artist Name",
  "thumbnail_url": "https://...",
  "duration": 180,
  "duration_formatted": "3:00",
  "filesize": 5242880,
  "filesize_formatted": "5.0 MB",
  "description": "Video description",
  "video_formats": [...],
  "available_formats": ["mp3", "mp4", "srt"]
}
```

#### `POST /api/download`
–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å.

**Request:**
```json
{
  "url": "https://youtube.com/watch?v=...",
  "format": "mp3",
  "video_quality": "720p",
  "audio_bitrate": "320k",
  "send_as_document": false,
  "send_audio_as_document": false
}
```

**Response:**
```json
{
  "task_id": "uuid-here",
  "queue_position": 3,
  "estimated_time": null
}
```

#### `GET /api/task/:id/status`
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏.

**Response:**
```json
{
  "status": "processing",
  "progress": null,
  "error": null,
  "created_at": "2024-11-24T12:00:00Z",
  "completed_at": null
}
```

#### `GET /api/user/:id/settings`
–ü–æ–ª—É—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Response:**
```json
{
  "download_format": "mp3",
  "video_quality": "720p",
  "audio_bitrate": "320k",
  "send_as_document": false,
  "send_audio_as_document": false,
  "plan": "free"
}
```

#### `PATCH /api/user/:id/settings`
–û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Request:**
```json
{
  "download_format": "mp4",
  "video_quality": "1080p",
  "audio_bitrate": "320k",
  "send_as_document": true,
  "send_audio_as_document": true,
  "plan": "premium"
}
```

#### `GET /api/user/:id/history?limit=50`
–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–≥—Ä—É–∑–æ–∫.

**Response:**
```json
[
  {
    "id": 123,
    "url": "https://...",
    "title": "Video Title",
    "format": "mp3",
    "status": "completed",
    "created_at": "2024-11-24T12:00:00Z",
    "completed_at": "2024-11-24T12:01:30Z",
    "error": null
  }
]
```

#### `GET /api/user/:id/queue`
–ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –æ—á–µ—Ä–µ–¥—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–∞–¥–∞—á–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ pending/processing).

**Response:**
```json
[
  {
    "id": "uuid",
    "url": "https://...",
    "format": "mp3",
    "status": "pending",
    "created_at": "2024-11-24T12:00:00Z",
    "queue_position": 2
  }
]
```

#### `GET /api/user/:id/stats`
–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Response:**
```json
{
  "total_downloads": 150,
  "successful_downloads": 145,
  "failed_downloads": 5,
  "total_size_bytes": 1073741824
}
```

#### `GET /api/services`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

**Response:**
```json
{
  "services": [
    { "name": "YouTube", "icon": "üé¨", "supported": true },
    { "name": "Spotify", "icon": "üéµ", "supported": true },
    ...
  ]
}
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç header `X-Telegram-Init-Data` —Å –≤–∞–ª–∏–¥–Ω—ã–º init data –æ—Ç Telegram Web App SDK.

–ü—Ä–∏–º–µ—Ä:
```javascript
const headers = {
  'Content-Type': 'application/json',
  'X-Telegram-Init-Data': Telegram.WebApp.initData
};
```

–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. HMAC-SHA256 –ø–æ–¥–ø–∏—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º bot token
2. –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç user_id –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### Error Responses

–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å –ø–æ–ª–µ–º `error`:

```json
{
  "error": "Rate limit exceeded"
}
```

–ö–æ–¥—ã –æ—à–∏–±–æ–∫:
- `400 Bad Request` - –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `401 Unauthorized` - –Ω–µ–≤–µ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `404 Not Found` - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `429 Too Many Requests` - –ø—Ä–µ–≤—ã—à–µ–Ω rate limit
- `500 Internal Server Error` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### Telegram Web App SDK

–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
Telegram.WebApp.ready()
Telegram.WebApp.expand()

// –î–æ—Å—Ç—É–ø –∫ init data –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
const initData = Telegram.WebApp.initData

// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
const user = Telegram.WebApp.initDataUnsafe.user

// –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
Telegram.WebApp.HapticFeedback.impactOccurred('light')
Telegram.WebApp.HapticFeedback.notificationOccurred('success')

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
Telegram.WebApp.showAlert(message)
Telegram.WebApp.showPopup(params)
Telegram.WebApp.showConfirm(message, callback)

// –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞
Telegram.WebApp.MainButton.show()
Telegram.WebApp.MainButton.onClick(callback)
Telegram.WebApp.MainButton.setParams({ text: '...', is_active: true })
```

## Troubleshooting

### Mini App –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `WEBAPP_URL` –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ HTTPS
2. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –±–æ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
4. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ BotFather

### –î–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–æ—Ç—É

1. –û—Ç–∫—Ä–æ–π Developer Tools –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü—Ä–æ–≤–µ—Ä—å Console –Ω–∞ –Ω–∞–ª–∏—á–∏–µ JavaScript –æ—à–∏–±–æ–∫
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `Telegram.WebApp` –¥–æ—Å—Ç—É–ø–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç JSON –¥–∞–Ω–Ω—ã—Ö

### –û—à–∏–±–∫–∞ CORS

Axum —Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CORS —á–µ—Ä–µ–∑ `tower-http`. –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `tower-http` –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å feature `cors`
2. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –≤ `webapp.rs`

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Telegram Mini Apps Documentation](https://core.telegram.org/bots/webapps)
- [Telegram Web App SDK](https://telegram.org/js/telegram-web-app.js)
- [Axum Web Framework](https://github.com/tokio-rs/axum)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
